!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/build/",r(r.s="cf3o")}({"1dtX":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("NEn2");t.YIN=n.YIN;var o=r("5v9E");t.AMDF=o.AMDF;var a=r("KRk7");t.ACF2PLUS=a.ACF2PLUS;var i=r("J6yq");t.DynamicWavelet=i.DynamicWavelet;var u=r("a/6g");t.Macleod=u.Macleod;var s=r("Lb/I");t.default={YIN:n.YIN,AMDF:o.AMDF,ACF2PLUS:a.ACF2PLUS,DynamicWavelet:i.DynamicWavelet,Macleod:u.Macleod,frequencies:s.frequencies}},"5tIq":function(e,t,r){"use strict";r.r(t),t.default={getAudioContext:function(){return window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.oAudioContext||window.msAudioContext,new AudioContext}}},"5v9E":function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o={sampleRate:44100,minFrequency:82,maxFrequency:1e3,ratio:5,sensitivity:.1};t.AMDF=function(e){void 0===e&&(e={});var t=n(n({},o),e),r=t.sampleRate,a=t.minFrequency,i=t.maxFrequency,u=t.sensitivity,s=t.ratio,l=[],f=Math.ceil(r/a),c=Math.floor(r/i);return function(e){var t,n,o,a,i,h,p,v,d=e.length,b=0,y=1/0,g=-1/0;for(a=0;a<d;a++)if(c<=a&&a<=f){for(p=0,v=a,b=0,t=[],n=[];p<d-a;b++,v++,p++)t[b]=e[p],n[b]=e[v];var m=t.length;for(o=[],h=0;h<m;h++)o[h]=t[h]-n[h];var A=0;for(h=0;h<m;h++)A+=Math.abs(o[h]);l[a]=A}for(i=c;i<f;i++)l[i]<y&&(y=l[i]),l[i]>g&&(g=l[i]);var k=Math.round(u*(g-y)+y);for(i=c;i<=f&&l[i]>k;i++);var C=c/2;y=l[i];var F=i;for(a=i-1;a<i+C&&a<=f;a++)l[a]<y&&(y=l[a],F=a);return Math.round(l[F]*s)<g?r/F:null}}},J6yq:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=6,a=3e3,i=3,u=.75,s={sampleRate:44100};t.DynamicWavelet=function(e){void 0===e&&(e={});var t=n(n({},s),e).sampleRate;return function(e){for(var r=[],n=[],s=e.length,l=null,f=0,c=0,h=0,p=0;p<s;p++){var v=e[p];f+=v,h=Math.max(h,v),c=Math.min(c,v)}for(var d,b,y,g=((h-=f/=s)>-1*(c-=f)?h:-1*c)*u,m=0,A=-1,k=e.length;d=~~(t/(Math.pow(2,m)*a)),!(k<2);){var C=void 0,F=-1e3,_=-1e6,M=-1e6,j=!1,x=!1;y=0,b=0;for(p=2;p<k;p++){var O=e[p]-f,E=e[p-1]-f;E<=0&&O>0&&(j=!0),E>=0&&O<0&&(x=!0),C=O-E,F>-1e3&&(x&&F<0&&C>=0&&Math.abs(O)>=g&&p>_+d&&(r[y++]=p,_=p,x=!1),j&&F>0&&C<=0&&Math.abs(O)>=g&&p>M+d&&(n[b++]=p,M=p,j=!1)),F=C}if(0===y&&0===b)break;var w=[];for(p=0;p<k;p++)w[p]=0;for(p=0;p<y;p++)for(var D=1;D<i;D++)p+D<y&&(w[Math.abs(r[p]-r[p+D])]+=1);var B=-1,P=-1;for(p=0;p<k;p++){var G=0;for(D=-1*d;D<=d;D++)p+D>=0&&p+D<k&&(G+=w[p+D]);G===P?p===2*B&&(B=p):G>P&&(P=G,B=p)}var N=0,q=0;for(D=-d;D<=d;D++)if(B+D>=0&&B+D<s){var S=w[B+D];S>0&&(q+=S,N+=(B+D)*S)}if(N/=q,A>-1&&Math.abs(2*N-A)<=2*d){l=t/(Math.pow(2,m-1)*A);break}if(A=N,++m>=o||k<2)break;var R=e.subarray(0);k===w.length&&(R=new Float32Array(k/2));for(p=0;p<k/2;p++)R[p]=(e[2*p]+e[2*p+1])/2;e=R,k/=2}return l}}},KRk7:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o={sampleRate:44100};t.ACF2PLUS=function(e){void 0===e&&(e=o);var t=n(n({},o),e).sampleRate;return function(e){var r,n,o,a,i=e.length,u=0;for(r=0;r<i;r++)u+=(a=e[r])*a;if((u=Math.sqrt(u/i))<.01)return-1;var s=0,l=i-1;for(r=0;r<i/2;r++)if(Math.abs(e[r])<.2){s=r;break}for(r=1;r<i/2;r++)if(Math.abs(e[i-r])<.2){l=i-r;break}var f=e.slice(s,l),c=f.length,h=new Array(c).fill(0);for(r=0;r<c;r++)for(n=0;n<c-r;n++)h[r]=h[r]+f[n]*f[n+r];for(o=0;h[o]>h[o+1];)o++;var p=-1,v=-1;for(r=o;r<c;r++)h[r]>p&&(p=h[r],v=r);var d=v,b=h[d-1],y=h[d],g=h[d+1],m=(b+g-2*y)/2;return m&&(d-=(g-b)/2/(2*m)),t/d}}},"Lb/I":function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(e,t){var r=e.map((function(e){return e(t)})).filter((function(e){return null!==e})).sort((function(e,t){return e-t}));if(1===r.length)return r[0];if(2===r.length)return 2*(n=r[0])>(o=r[1])?Math.sqrt(n*o):n;var n=r[0],o=r[1],a=r[r.length-2],i=r[r.length-1],u=2*n>o?r:r.slice(1),s=2*a>i?u:u.slice(0,-1);return Math.pow(s.reduce((function(e,t){return e*t}),1),1/s.length)}Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_FREQUENCIES_PARAMS={tempo:120,quantization:4,sampleRate:44100},t.frequencies=function(e,r,a){void 0===a&&(a={});var i,u=n(n({},t.DEFAULT_FREQUENCIES_PARAMS),a),s=u.tempo,l=u.quantization,f=u.sampleRate,c=r.length,h=Math.round(60*f/(l*s));i=Array.isArray(e)?o.bind(null,e):e;for(var p=[],v=0,d=c-h;v<=d;v+=h){var b=i(r.slice(v,v+h));p.push(b)}return p}},NEn2:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o={threshold:.1,sampleRate:44100,probabilityThreshold:.1};t.YIN=function(e){void 0===e&&(e={});var t=n(n({},o),e),r=t.threshold,a=t.sampleRate,i=t.probabilityThreshold;return function(e){var t;for(t=1;t<e.length;t*=2);for(var n,o=(t/=2)/2,u=new Float32Array(o),s=0,l=0;l<o;l++)u[l]=0;for(l=1;l<o;l++)for(var f=0;f<o;f++){var c=e[f]-e[f+l];u[l]+=c*c}u[0]=1,u[1]=1;var h,p,v,d=0;for(l=1;l<o;l++)d+=u[l],u[l]*=l/d;for(n=2;n<o;n++)if(u[n]<r){for(;n+1<o&&u[n+1]<u[n];)n++;s=1-u[n];break}if(n===o||u[n]>=r)return null;if(s<i)return null;if(v=n+1<o?n+1:n,(p=n<1?n:n-1)===n)h=u[n]<=u[v]?n:v;else if(v===n)h=u[n]<=u[p]?n:p;else{var b=u[p],y=u[n],g=u[v];h=n+(g-b)/(2*(2*y-g-b))}return a/h}}},"a/6g":function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o={bufferSize:1024,cutoff:.97,sampleRate:44100};t.Macleod=function(e){void 0===e&&(e={});var t,r,a=n(n({},o),e),i=a.bufferSize,u=a.cutoff,s=a.sampleRate,l=new Float32Array(i),f=new Float32Array(i),c=[],h=[],p=[];function v(e){var n=l[e-1],o=l[e],a=l[e+1],i=a+n-2*o;if(0===i)t=e,r=o;else{var u=n-a;t=e+u/(2*i),r=o-u*u/(8*i)}}return function(e){var n;c=[],h=[],p=[],function(e){var t,r;f[0]=e[0]*e[0];for(var n=1;n<e.length;n+=1)f[n]=e[n]*e[n]+f[n-1];for(var o=0;o<e.length;o++){t=0,r=f[e.length-1-o]+f[e.length-1]-f[o];for(n=0;n<e.length-o;n++)t+=e[n]*e[n+o];l[o]=2*t/r}}(e),function(){for(var e=0,t=0;e<(l.length-1)/3&&l[e]>0;)e++;for(;e<l.length-1&&l[e]<=0;)e++;for(0==e&&(e=1);e<l.length-1;)if(l[e]>l[e-1]&&l[e]>=l[e+1]&&(0==t?t=e:l[e]>l[t]&&(t=e)),++e<l.length-1&&l[e]<=0)for(t>0&&(c.push(t),t=0);e<l.length-1&&l[e]<=0;)e++;t>0&&c.push(t)}();for(var o=-1/0,a=0;a<c.length;a++){var i=c[a];o=Math.max(o,l[i]),l[i]>.5&&(v(i),p.push(r),h.push(t),o=Math.max(o,r))}if(h.length){var d=u*o,b=0;for(a=0;a<p.length;a++)if(p[a]>=d){b=a;break}var y=h[b],g=s/y;n=g>80?g:-1}else n=-1;return{probability:o,freq:n}}}},cf3o:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return s}));var n=r("eolz"),o=r("sEk6"),a=r("hg4W"),i=r("5tIq");function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.audioCtx=i.default.getAudioContext(),this.tick=null,this.tickVolume=null,this.soundHz=1e3,this.scheduledNotes=this.appendTimingOffset(t,o,n).flat(),this.instrument=r,this.initAudio()}var t,r,s;return t=e,(r=[{key:"initAudio",value:function(){this.tick=this.audioCtx.createOscillator(),this.tickVolume=this.audioCtx.createGain(),this.tick.type="square",this.tick.frequency.value=this.soundHz,this.tickVolume.gain.value=0,this.tick.connect(this.tickVolume),this.tick.start(0)}},{key:"start",value:function(){for(var e=this.audioCtx.currentTime,t=0;t<this.scheduledNotes.length;t++){var r=this.scheduledNotes[t].note;if("GhostNote"!==r.attrs.type){var i=r.getKeyProps()[0],u=i.key,s=i.octave,l=a.default.getOffsetNote(u,s,0-o.default.getInstrumentKeyOffset(this.instrument)),f=n.default.getFrequencyForNote(l.name,l.octave);this.playNoteAtTime(f,e+this.scheduledNotes[t].timing_offset)}}}},{key:"playNoteAtTime",value:function(e,t){this.tick.frequency.cancelScheduledValues(t),this.tick.frequency.setValueAtTime(e,t),this.tickVolume.gain.cancelScheduledValues(t),this.tickVolume.gain.setValueAtTime(0,t),this.tickVolume.gain.linearRampToValueAtTime(1,t+.001),this.tickVolume.gain.linearRampToValueAtTime(0,t+.001+.2)}},{key:"stop",value:function(){this.tickVolume.gain.value=0}},{key:"pause",value:function(){this.audioCtx.suspend()}},{key:"resume",value:function(){this.audioCtx.resume()}},{key:"setController",value:function(){var e=this;document.getElementById("song-player-controller").addEventListener("change",(function(t){t.target.checked?e.tickVolume.connect(e.audioCtx.destination):e.tickVolume.disconnect(e.audioCtx.destination)}))}},{key:"appendTimingOffset",value:function(e,t,r){for(var n=0;n<e.length;n++){var o=e[n];if(0!==o.length){var a=n*(t/r)*60;e[n][0].timing_offset=a;for(var i=0;i<o.length;i++)if(i!==o.length-1){var u=a+o[i+1].percentage*(t/r)*60;e[n][i+1].timing_offset=u}}}return e}}])&&u(t.prototype,r),s&&u(t,s),e}()},eolz:function(e,t,r){"use strict";r.r(t);var n=r("r1bH"),o=(r("1dtX"),[7902.13,7458.62,7040,6644.88,6271.93,5919.91,5587.65,5274.04,4978.03,4698.64,4434.92,4186.01,3951.07,3729.31,3520,3322.44,3135.96,2959.96,2793.83,2637.02,2489.02,2349.32,2217.46,2093,1975.53,1864.66,1760,1661.22,1567.98,1479.98,1396.91,1318.51,1244.51,1174.66,1108.73,1046.5,987.767,932.328,880,830.609,783.991,739.989,698.456,659.255,622.254,587.33,554.365,523.251,493.883,466.164,440,415.305,391.995,369.994,349.228,329.628,311.127,293.665,277.183,261.626,246.942,233.082,220,207.652,195.998,184.997,174.614,164.814,155.563,146.832,138.591,130.813,123.471,116.541,110,103.826,97.9989,92.4986,87.3071,82.4069,77.7817,73.4162,69.2957,65.4064,61.7354,58.2705,55,51.9131,48.9994,46.2493,43.6535,41.2034,38.8909,36.7081,34.6478,32.7032,30.8677,29.1352,27.5,25.9565,24.4997,23.1247,21.8268,20.6017,19.4454,18.354,17.3239,16.3516]),a=["B","A#","A","G#","G","F#","F","E","D#","D","C#","C"],i={C:0,"C#":1,DB:1,D:2,"D#":3,EB:3,E:4,F:5,"F#":6,GB:6,G:7,"G#":8,AB:8,A:9,"A#":10,BB:10,B:11};function u(e){for(var t=o.length,r=0,n=0;n<t-1;n++){if(0==n&&e>o[n]){r=0,0;break}if(o[n]>=e&&e>o[n+1]){(r=o[n]-e<e-o[n+1]?n:n+1)==n?n+1:n;break}n==t-2&&(r=t-1,t-1)}return{key:a[r%a.length],octave:8-Math.floor(r/a.length)}}t.default={getFrequencyForNote:function(e,t){for(var r,i=0;i<a.length;i++)if(n.default.compareKeys(e,a[i])){r=i;break}return o[o.length-1-t*a.length-(a.length-r-1)]},getNoteFromSamples:function(e,t,r){for(var n=Math.floor(t/r),o=n+2,a=0,i=-1,s=n-2;s<=o;s++){for(var l=0,f=0;f<1024;f++)l+=(e[f]-128)/128*((e[f+s]-128)/128);var c=l/(1024+s);if(c>a&&(a=c,i=s),c>.9)break}return a>.0025?u(t/i):[]},estimateNote:u,getIndexForNote:function(e,t){return 12*t+i[e]}}},hg4W:function(e,t,r){"use strict";r.r(t);var n=r("r1bH");function o(e){return{"C major":{type:"#",notes:{}},"A minor":{type:"#",notes:{}},"G major":{type:"#",notes:{F:!0}},"E minor":{type:"#",notes:{F:!0}},"D major":{type:"#",notes:{F:!0,C:!0}},"B minor":{type:"#",notes:{F:!0,C:!0}},"A major":{type:"#",notes:{F:!0,C:!0,G:!0}},"F# minor":{type:"#",notes:{F:!0,C:!0,G:!0}},"E major":{type:"#",notes:{F:!0,C:!0,G:!0,D:!0}},"B major":{type:"#",notes:{F:!0,C:!0,G:!0,D:!0,A:!0}},"F# major":{type:"#",notes:{F:!0,G:!0,A:!0,C:!0,D:!0,E:!0}},"C# major":{type:"#",notes:{F:!0,G:!0,A:!0,C:!0,D:!0,E:!0,B:!0}},"F major":{type:"b",notes:{B:!0}},"D minor":{type:"b",notes:{B:!0}},"Bb major":{type:"b",notes:{B:!0,E:!0}},"G minor":{type:"b",notes:{B:!0,E:!0}},"Eb major":{type:"b",notes:{B:!0,E:!0,A:!0}},"C minor":{type:"b",notes:{B:!0,E:!0,A:!0}},"Ab major":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0}},"F minor":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0}},"Db major":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0,G:!0}},"Bb minor":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0,G:!0}},"Gb major":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0,G:!0,C:!0}},"Eb minor":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0,G:!0,C:!0}},"Cb major":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0,G:!0,C:!0,F:!0}},"Ab minor":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0,G:!0,C:!0,F:!0}}}[e]}t.default={getKeySignatureInfo:o,getOffsetNote:function(e,t,r){for(var o=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],a=0,i=0;i<o.length;i++)if(n.default.compareKeys(o[i],e)){a=i;break}return{name:o[(o.length+a+r)%o.length],octave:t+Math.floor((a+r)/o.length)}},getKeySignatureStaffWidth:function(e){var t=o(e);return 300+10*Object.keys(t.notes).length}}},r1bH:function(e,t,r){"use strict";r.r(t),t.default={compareKeys:function(e,t){return null!=e&&null!=t&&(e.toLowerCase()==t.toLowerCase()||{ab:"g#",a:"a","a#":"bb",bb:"a#",b:"cb","b#":"c",cb:"b",c:"b#","c#":"db",db:"c#",d:"d","d#":"eb",eb:"d#",e:"fb","e#":"f",fb:"e",f:"f","f#":"gb",gb:"f#",g:"g","g#":"ab"}[e.toLowerCase()]==t.toLowerCase())}}},sEk6:function(e,t,r){"use strict";r.r(t),t.default={getInstrumentKeyOffset:function(e){return{guitar:12,clarinet:2,bass_clarinet:14,soprano_saxophone:2,alto_saxophone:9,tenor_saxophone:14,french_horn:7,trumpet:2,piano:0,singing:0}[e]},getInstrumentFingering:function(e){return{guitar:"guitar",piccolo:"picolo",clarinet:"clarinet",bass_clarinet:"clarinet",soprano_saxophone:"saxophone",alto_saxophone:"saxophone",tenor_saxophone:"saxophone",baritone_saxophone:"saxophone",french_horn:"trumpet",trumpet:"trumpet",xylophone:"xylophone",glockenspiel:"glockenspiel",piano:"piano"}[e]}}}});