!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/build/",n(n.s="cf3o")}({"1dtX":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("NEn2");t.YIN=r.YIN;var o=n("5v9E");t.AMDF=o.AMDF;var a=n("KRk7");t.ACF2PLUS=a.ACF2PLUS;var i=n("J6yq");t.DynamicWavelet=i.DynamicWavelet;var u=n("a/6g");t.Macleod=u.Macleod;var s=n("Lb/I");t.default={YIN:r.YIN,AMDF:o.AMDF,ACF2PLUS:a.ACF2PLUS,DynamicWavelet:i.DynamicWavelet,Macleod:u.Macleod,frequencies:s.frequencies}},"5tIq":function(e,t,n){"use strict";n.r(t),t.default={getAudioContext:function(){return window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.oAudioContext||window.msAudioContext,new AudioContext}}},"5v9E":function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o={sampleRate:44100,minFrequency:82,maxFrequency:1e3,ratio:5,sensitivity:.1};t.AMDF=function(e){void 0===e&&(e={});var t=r(r({},o),e),n=t.sampleRate,a=t.minFrequency,i=t.maxFrequency,u=t.sensitivity,s=t.ratio,l=[],f=Math.ceil(n/a),c=Math.floor(n/i);return function(e){var t,r,o,a,i,h,p,v,d=e.length,y=0,b=1/0,g=-1/0;for(a=0;a<d;a++)if(c<=a&&a<=f){for(p=0,v=a,y=0,t=[],r=[];p<d-a;y++,v++,p++)t[y]=e[p],r[y]=e[v];var m=t.length;for(o=[],h=0;h<m;h++)o[h]=t[h]-r[h];var A=0;for(h=0;h<m;h++)A+=Math.abs(o[h]);l[a]=A}for(i=c;i<f;i++)l[i]<b&&(b=l[i]),l[i]>g&&(g=l[i]);var F=Math.round(u*(g-b)+b);for(i=c;i<=f&&l[i]>F;i++);var k=c/2;b=l[i];var C=i;for(a=i-1;a<i+k&&a<=f;a++)l[a]<b&&(b=l[a],C=a);return Math.round(l[C]*s)<g?n/C:null}}},J6yq:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=6,a=3e3,i=3,u=.75,s={sampleRate:44100};t.DynamicWavelet=function(e){void 0===e&&(e={});var t=r(r({},s),e).sampleRate;return function(e){for(var n=[],r=[],s=e.length,l=null,f=0,c=0,h=0,p=0;p<s;p++){var v=e[p];f+=v,h=Math.max(h,v),c=Math.min(c,v)}for(var d,y,b,g=((h-=f/=s)>-1*(c-=f)?h:-1*c)*u,m=0,A=-1,F=e.length;d=~~(t/(Math.pow(2,m)*a)),!(F<2);){var k=void 0,C=-1e3,_=-1e6,M=-1e6,j=!1,x=!1;b=0,y=0;for(p=2;p<F;p++){var O=e[p]-f,E=e[p-1]-f;E<=0&&O>0&&(j=!0),E>=0&&O<0&&(x=!0),k=O-E,C>-1e3&&(x&&C<0&&k>=0&&Math.abs(O)>=g&&p>_+d&&(n[b++]=p,_=p,x=!1),j&&C>0&&k<=0&&Math.abs(O)>=g&&p>M+d&&(r[y++]=p,M=p,j=!1)),C=k}if(0===b&&0===y)break;var w=[];for(p=0;p<F;p++)w[p]=0;for(p=0;p<b;p++)for(var D=1;D<i;D++)p+D<b&&(w[Math.abs(n[p]-n[p+D])]+=1);var B=-1,P=-1;for(p=0;p<F;p++){var q=0;for(D=-1*d;D<=d;D++)p+D>=0&&p+D<F&&(q+=w[p+D]);q===P?p===2*B&&(B=p):q>P&&(P=q,B=p)}var G=0,N=0;for(D=-d;D<=d;D++)if(B+D>=0&&B+D<s){var S=w[B+D];S>0&&(N+=S,G+=(B+D)*S)}if(G/=N,A>-1&&Math.abs(2*G-A)<=2*d){l=t/(Math.pow(2,m-1)*A);break}if(A=G,++m>=o||F<2)break;var R=e.subarray(0);F===w.length&&(R=new Float32Array(F/2));for(p=0;p<F/2;p++)R[p]=(e[2*p]+e[2*p+1])/2;e=R,F/=2}return l}}},KRk7:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o={sampleRate:44100};t.ACF2PLUS=function(e){void 0===e&&(e=o);var t=r(r({},o),e).sampleRate;return function(e){var n,r,o,a,i=e.length,u=0;for(n=0;n<i;n++)u+=(a=e[n])*a;if((u=Math.sqrt(u/i))<.01)return-1;var s=0,l=i-1;for(n=0;n<i/2;n++)if(Math.abs(e[n])<.2){s=n;break}for(n=1;n<i/2;n++)if(Math.abs(e[i-n])<.2){l=i-n;break}var f=e.slice(s,l),c=f.length,h=new Array(c).fill(0);for(n=0;n<c;n++)for(r=0;r<c-n;r++)h[n]=h[n]+f[r]*f[r+n];for(o=0;h[o]>h[o+1];)o++;var p=-1,v=-1;for(n=o;n<c;n++)h[n]>p&&(p=h[n],v=n);var d=v,y=h[d-1],b=h[d],g=h[d+1],m=(y+g-2*b)/2;return m&&(d-=(g-y)/2/(2*m)),t/d}}},"Lb/I":function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(e,t){var n=e.map((function(e){return e(t)})).filter((function(e){return null!==e})).sort((function(e,t){return e-t}));if(1===n.length)return n[0];if(2===n.length)return 2*(r=n[0])>(o=n[1])?Math.sqrt(r*o):r;var r=n[0],o=n[1],a=n[n.length-2],i=n[n.length-1],u=2*r>o?n:n.slice(1),s=2*a>i?u:u.slice(0,-1);return Math.pow(s.reduce((function(e,t){return e*t}),1),1/s.length)}Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_FREQUENCIES_PARAMS={tempo:120,quantization:4,sampleRate:44100},t.frequencies=function(e,n,a){void 0===a&&(a={});var i,u=r(r({},t.DEFAULT_FREQUENCIES_PARAMS),a),s=u.tempo,l=u.quantization,f=u.sampleRate,c=n.length,h=Math.round(60*f/(l*s));i=Array.isArray(e)?o.bind(null,e):e;for(var p=[],v=0,d=c-h;v<=d;v+=h){var y=i(n.slice(v,v+h));p.push(y)}return p}},NEn2:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o={threshold:.1,sampleRate:44100,probabilityThreshold:.1};t.YIN=function(e){void 0===e&&(e={});var t=r(r({},o),e),n=t.threshold,a=t.sampleRate,i=t.probabilityThreshold;return function(e){var t;for(t=1;t<e.length;t*=2);for(var r,o=(t/=2)/2,u=new Float32Array(o),s=0,l=0;l<o;l++)u[l]=0;for(l=1;l<o;l++)for(var f=0;f<o;f++){var c=e[f]-e[f+l];u[l]+=c*c}u[0]=1,u[1]=1;var h,p,v,d=0;for(l=1;l<o;l++)d+=u[l],u[l]*=l/d;for(r=2;r<o;r++)if(u[r]<n){for(;r+1<o&&u[r+1]<u[r];)r++;s=1-u[r];break}if(r===o||u[r]>=n)return null;if(s<i)return null;if(v=r+1<o?r+1:r,(p=r<1?r:r-1)===r)h=u[r]<=u[v]?r:v;else if(v===r)h=u[r]<=u[p]?r:p;else{var y=u[p],b=u[r],g=u[v];h=r+(g-y)/(2*(2*b-g-y))}return a/h}}},"a/6g":function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o={bufferSize:1024,cutoff:.97,sampleRate:44100};t.Macleod=function(e){void 0===e&&(e={});var t,n,a=r(r({},o),e),i=a.bufferSize,u=a.cutoff,s=a.sampleRate,l=new Float32Array(i),f=new Float32Array(i),c=[],h=[],p=[];function v(e){var r=l[e-1],o=l[e],a=l[e+1],i=a+r-2*o;if(0===i)t=e,n=o;else{var u=r-a;t=e+u/(2*i),n=o-u*u/(8*i)}}return function(e){var r;c=[],h=[],p=[],function(e){var t,n;f[0]=e[0]*e[0];for(var r=1;r<e.length;r+=1)f[r]=e[r]*e[r]+f[r-1];for(var o=0;o<e.length;o++){t=0,n=f[e.length-1-o]+f[e.length-1]-f[o];for(r=0;r<e.length-o;r++)t+=e[r]*e[r+o];l[o]=2*t/n}}(e),function(){for(var e=0,t=0;e<(l.length-1)/3&&l[e]>0;)e++;for(;e<l.length-1&&l[e]<=0;)e++;for(0==e&&(e=1);e<l.length-1;)if(l[e]>l[e-1]&&l[e]>=l[e+1]&&(0==t?t=e:l[e]>l[t]&&(t=e)),++e<l.length-1&&l[e]<=0)for(t>0&&(c.push(t),t=0);e<l.length-1&&l[e]<=0;)e++;t>0&&c.push(t)}();for(var o=-1/0,a=0;a<c.length;a++){var i=c[a];o=Math.max(o,l[i]),l[i]>.5&&(v(i),p.push(n),h.push(t),o=Math.max(o,n))}if(h.length){var d=u*o,y=0;for(a=0;a<p.length;a++)if(p[a]>=d){y=a;break}var b=h[y],g=s/b;r=g>80?g:-1}else r=-1;return{probability:o,freq:r}}}},cf3o:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n("eolz"),o=n("sEk6"),a=n("hg4W"),i=n("5tIq");function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.audioCtx=i.default.getAudioContext(),this.tick=null,this.tickVolume=null,this.soundHz=1e3,this.scheduledNotes=this.appendTimingOffset(t,o,r).flat(),this.instrument=n,this.initAudio()}var t,n,s;return t=e,(n=[{key:"initAudio",value:function(){this.tick=this.audioCtx.createOscillator(),this.tickVolume=this.audioCtx.createGain(),this.tick.type="square",this.tick.frequency.value=this.soundHz,this.tickVolume.gain.value=0,this.tick.connect(this.tickVolume),this.tick.start(0)}},{key:"start",value:function(){for(var e=this.audioCtx.currentTime,t=0;t<this.scheduledNotes.length;t++){var n=this.scheduledNotes[t].note;if("GhostNote"!==n.attrs.type){var i=n.getKeyProps()[0],u=i.key,s=i.octave,l=a.default.getOffsetNote(u,s,0-o.default.getInstrumentKeyOffset(this.instrument)),f=r.default.getFrequencyForNote(l.name,l.octave);this.playNoteAtTime(f,e+this.scheduledNotes[t].timing_offset)}}}},{key:"playNoteAtTime",value:function(e,t){this.tick.frequency.cancelScheduledValues(t),this.tick.frequency.setValueAtTime(e,t),this.tickVolume.gain.cancelScheduledValues(t),this.tickVolume.gain.setValueAtTime(0,t),this.tickVolume.gain.linearRampToValueAtTime(1,t+.001),this.tickVolume.gain.linearRampToValueAtTime(0,t+.001+.2)}},{key:"stop",value:function(){this.tickVolume.gain.value=0}},{key:"pause",value:function(){this.audioCtx.suspend()}},{key:"resume",value:function(){this.audioCtx.resume()}},{key:"setController",value:function(){var e=this;document.getElementById("song-player-controller").addEventListener("change",(function(t){t.target.checked?e.tickVolume.connect(e.audioCtx.destination):e.tickVolume.disconnect(e.audioCtx.destination)}))}},{key:"appendTimingOffset",value:function(e,t,n){for(var r=0;r<e.length;r++){var o=e[r];if(0!==o.length){var a=r*(t/n)*60;e[r][0].timing_offset=a;for(var i=0;i<o.length;i++)if(i!==o.length-1){var u=a+o[i+1].percentage*(t/n)*60;e[r][i+1].timing_offset=u}}}return e}}])&&u(t.prototype,n),s&&u(t,s),e}()},eolz:function(e,t,n){"use strict";n.r(t);var r=n("r1bH"),o=n("1dtX"),a=n.n(o),i=[7902.13,7458.62,7040,6644.88,6271.93,5919.91,5587.65,5274.04,4978.03,4698.64,4434.92,4186.01,3951.07,3729.31,3520,3322.44,3135.96,2959.96,2793.83,2637.02,2489.02,2349.32,2217.46,2093,1975.53,1864.66,1760,1661.22,1567.98,1479.98,1396.91,1318.51,1244.51,1174.66,1108.73,1046.5,987.767,932.328,880,830.609,783.991,739.989,698.456,659.255,622.254,587.33,554.365,523.251,493.883,466.164,440,415.305,391.995,369.994,349.228,329.628,311.127,293.665,277.183,261.626,246.942,233.082,220,207.652,195.998,184.997,174.614,164.814,155.563,146.832,138.591,130.813,123.471,116.541,110,103.826,97.9989,92.4986,87.3071,82.4069,77.7817,73.4162,69.2957,65.4064,61.7354,58.2705,55,51.9131,48.9994,46.2493,43.6535,41.2034,38.8909,36.7081,34.6478,32.7032,30.8677,29.1352,27.5,25.9565,24.4997,23.1247,21.8268,20.6017,19.4454,18.354,17.3239,16.3516],u=["B","A#","A","G#","G","F#","F","E","D#","D","C#","C"],s={C:0,"C#":1,DB:1,D:2,"D#":3,EB:3,E:4,F:5,"F#":6,GB:6,G:7,"G#":8,AB:8,A:9,"A#":10,BB:10,B:11};function l(e){for(var t=i.length,n=0,r=0;r<t-1;r++){if(0==r&&e>i[r]){n=0,0;break}if(i[r]>=e&&e>i[r+1]){(n=i[r]-e<e-i[r+1]?r:r+1)==r?r+1:r;break}r==t-2&&(n=t-1,t-1)}return{key:u[n%u.length],octave:8-Math.floor(n/u.length)}}t.default={getFrequencyForNote:function(e,t){for(var n,o=0;o<u.length;o++)if(r.default.compareKeys(e,u[o])){n=o;break}return i[i.length-1-t*u.length-(u.length-n-1)]},getNoteFromSamples:function(e,t,n){if(n<300)return null!=new a.a.AMDF({sampleRate:44100,minFrequency:82,maxFrequency:n,ratio:5,sensitivity:.1})(e)?l(c):[];for(var r=0,o=-1,i=8;i<=1e3;i++){for(var u=0,s=0;s<1024;s++)u+=(e[s]-128)/128*((e[s+i]-128)/128);var f=u/(1024+i);if(f>r&&(r=f,o=i),f>.9)break}if(r>.0025){var c=t/o;return l(c)}return[]},estimateNote:l,getIndexForNote:function(e,t){return console.log(e),12*t+s[e]}}},hg4W:function(e,t,n){"use strict";n.r(t);var r=n("r1bH");function o(e){return{"C major":{type:"#",notes:{}},"A minor":{type:"#",notes:{}},"G major":{type:"#",notes:{F:!0}},"E minor":{type:"#",notes:{F:!0}},"D major":{type:"#",notes:{F:!0,C:!0}},"B minor":{type:"#",notes:{F:!0,C:!0}},"A major":{type:"#",notes:{F:!0,C:!0,G:!0}},"F# minor":{type:"#",notes:{F:!0,C:!0,G:!0}},"E major":{type:"#",notes:{F:!0,C:!0,G:!0,D:!0}},"B major":{type:"#",notes:{F:!0,C:!0,G:!0,D:!0,A:!0}},"F# major":{type:"#",notes:{F:!0,G:!0,A:!0,C:!0,D:!0,E:!0}},"C# major":{type:"#",notes:{F:!0,G:!0,A:!0,C:!0,D:!0,E:!0,B:!0}},"F major":{type:"b",notes:{B:!0}},"D minor":{type:"b",notes:{B:!0}},"Bb major":{type:"b",notes:{B:!0,E:!0}},"G minor":{type:"b",notes:{B:!0,E:!0}},"Eb major":{type:"b",notes:{B:!0,E:!0,A:!0}},"C minor":{type:"b",notes:{B:!0,E:!0,A:!0}},"Ab major":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0}},"F minor":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0}},"Db major":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0,G:!0}},"Bb minor":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0,G:!0}},"Gb major":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0,G:!0,C:!0}},"Eb minor":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0,G:!0,C:!0}},"Cb major":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0,G:!0,C:!0,F:!0}},"Ab minor":{type:"b",notes:{B:!0,E:!0,A:!0,D:!0,G:!0,C:!0,F:!0}}}[e]}t.default={getKeySignatureInfo:o,getOffsetNote:function(e,t,n){for(var o=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],a=0,i=0;i<o.length;i++)if(r.default.compareKeys(o[i],e)){a=i;break}return{name:o[(o.length+a+n)%o.length],octave:t+Math.floor((a+n)/o.length)}},getKeySignatureStaffWidth:function(e){var t=o(e);return 300+10*Object.keys(t.notes).length}}},r1bH:function(e,t,n){"use strict";n.r(t),t.default={compareKeys:function(e,t){return null!=e&&null!=t&&(e.toLowerCase()==t.toLowerCase()||{ab:"g#",a:"a","a#":"bb",bb:"a#",b:"cb","b#":"c",cb:"b",c:"b#","c#":"db",db:"c#",d:"d","d#":"eb",eb:"d#",e:"fb","e#":"f",fb:"e",f:"f","f#":"gb",gb:"f#",g:"g","g#":"ab"}[e.toLowerCase()]==t.toLowerCase())}}},sEk6:function(e,t,n){"use strict";n.r(t),t.default={getInstrumentKeyOffset:function(e){return{guitar:12,clarinet:2,bass_clarinet:14,soprano_saxophone:2,alto_saxophone:9,tenor_saxophone:14,french_horn:7,trumpet:2,piano:0,singing:0}[e]},getInstrumentFingering:function(e){return{guitar:"guitar",piccolo:"picolo",clarinet:"clarinet",bass_clarinet:"clarinet",soprano_saxophone:"saxophone",alto_saxophone:"saxophone",tenor_saxophone:"saxophone",baritone_saxophone:"saxophone",french_horn:"trumpet",trumpet:"trumpet",xylophone:"xylophone",glockenspiel:"glockenspiel",piano:"piano"}[e]}}}});